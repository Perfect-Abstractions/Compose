---
sidebar_position: 99
title: "ExampleDiamond"
description: "Contract documentation for ExampleDiamond"
gitSource: "https://github.com/maxnorm/Compose/blob/8fd3d0c28913baf3b948e02cb6af2111875ad106/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Contract documentation for ExampleDiamond
</DocSubtitle>

<Callout type="info" title="Key Features">
- Acts as the central dispatcher for all external calls to the diamond.
- Manages the registration and unregistration of facets and their associated function selectors.
- Facilitates diamond initialization by setting the owner and adding initial facets.
</Callout>

## Overview

The ExampleDiamond contract serves as the core of a Compose diamond. It acts as the central router, directing all external calls to the appropriate facet based on function selectors. This contract also manages diamond initialization, including setting the owner and registering facets.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {ExampleDiamond} from "./ExampleDiamond.sol";
import {DiamondCutFacet} from "@compose/diamond-core/facets/DiamondCutFacet.sol";
import {DiamondLoupeFacet} from "@compose/diamond-core/facets/DiamondLoupeFacet.sol";

contract DeployExampleDiamond {
    address public diamondAddress;

    function deploy() public {
        // Example facet addresses and their selectors
        address diamondCutFacet = address(new DiamondCutFacet());
        address diamondLoupeFacet = address(new DiamondLoupeFacet());

        // Define facet cuts for initialization
        ExampleDiamond.FacetCut[] memory facets = new ExampleDiamond.FacetCut[](2);
        facets[0] = ExampleDiamond.FacetCut({
            facetAddress: diamondCutFacet,
            action: ExampleDiamond.FacetCutAction.Add,
            functionSelectors: DiamondCutFacet.getFunctionSelectors()
        });
        facets[1] = ExampleDiamond.FacetCut({
            facetAddress: diamondLoupeFacet,
            action: ExampleDiamond.FacetCutAction.Add,
            functionSelectors: DiamondLoupeFacet.getFunctionSelectors()
        });

        // Deploy the diamond and initialize it
        ExampleDiamond exampleDiamond = new ExampleDiamond(facets, msg.sender);
        diamondAddress = address(exampleDiamond);
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond with essential facets like DiamondCutFacet and DiamondLoupeFacet during deployment.
- Ensure the owner is set correctly during initialization, as they will have the authority to manage facets.
- Use explicit `FacetCutAction` values (Add, Replace, Remove) for clarity and to prevent unintended state changes.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The constructor of ExampleDiamond sets the owner and registers facets. Ensure the owner address is trusted. Incorrectly configured facet cuts during initialization can lead to unexpected routing or loss of functionality. Access to `DiamondCutFacet` functions is typically restricted to the owner, preventing unauthorized modifications to the diamond's facet configuration.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-19T22:26:30.313Z" />
