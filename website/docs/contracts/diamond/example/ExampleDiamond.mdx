---
sidebar_position: 99
title: "ExampleDiamond"
description: "Example Diamond contract for Compose diamonds"
gitSource: "https://github.com/maxnorm/Compose/blob/00106e341b257629f718c654a349c0ad60a7cf8a/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Example Diamond contract for Compose diamonds
</DocSubtitle>

<Callout type="info" title="Key Features">
- Supports initialization of the diamond with multiple facets.
- Manages the registration of function selectors to facet addresses for routing.
- Establishes the initial owner of the diamond contract.
</Callout>

## Overview

This contract serves as a foundational example for Compose diamonds. It demonstrates the basic structure and initialization process for adding facets to a diamond proxy. Its primary purpose is to set up the diamond's initial state, including registering facets and assigning ownership.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {DiamondInit, FacetCut, FacetCutAction} from "@compose/diamond/contracts/DiamondInit.sol";

contract ExampleDiamondInit is DiamondInit {
    function init(FacetCut[] memory _diamondCuts) public payable {
        // Call the parent init function to process facet cuts
        processCuts(_diamondCuts);
    }

    // Example of how you might define cuts for initialization
    function getExampleCuts() public pure returns (FacetCut[] memory) {
        // Assume MyFacet and AnotherFacet are deployed and have their addresses
        // and selectors defined.
        FacetCut[] memory cuts = new FacetCut[](2);

        // Example cut for MyFacet
        cuts[0] = FacetCut({
            facetAddress: address(0x123...\/\* MyFacet address *\/ ),
            action: FacetCutAction.Add,
            functionSelectors: new bytes4[](0) // Populate with actual selectors
        });

        // Example cut for AnotherFacet
        cuts[1] = FacetCut({
            facetAddress: address(0x456...\/\* AnotherFacet address *\/ ),
            action: FacetCutAction.Add,
            functionSelectors: new bytes4[](0) // Populate with actual selectors
        });

        return cuts;
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond with all necessary facets and their selectors during deployment.
- Ensure the `owner` is set correctly to manage the diamond's upgradeability.
- Use explicit initializer functions rather than constructors for deployment flows.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The constructor grants significant control over the diamond's initial state and ownership. Ensure that the provided facet addresses are trusted and that the function selectors are correctly mapped to prevent unintended behavior. Access control for subsequent upgrades is managed by the owner.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-20T03:05:07.302Z" />
