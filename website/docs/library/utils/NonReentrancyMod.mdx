---
sidebar_position: 1
title: "NonReentrancyMod"
description: "Prevents reentrant calls within functions."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/libraries/NonReentrancyMod.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Prevents reentrant calls within functions.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Prevents reentrant function calls, mitigating a class of common smart contract exploits.
- Simple `enter` and `exit` functions provide a clear, explicit mechanism for managing reentrancy guards.
</Callout>

<Callout type="info" title="Module Usage">
This module provides internal functions for use in your custom facets. Import it to access shared logic and storage.
</Callout>

## Overview

This library provides essential non-reentrancy guards for your facets. By preventing reentrant calls, it enhances the security and predictability of your diamond's state transitions. Integrate it to safeguard against common reentrancy vulnerabilities.

---

## Storage

### State Variables

<PropertyTable
  properties={[
    {
      name: "NON_REENTRANT_SLOT",
      type: "bytes32",
      description: "Reentrancy guard storage slot (Value: `keccak256(\"compose.nonreentrant\")`)"
    }
  ]}
  showRequired={false}
/>

## Functions

### enter

How to use as a library in user facets How to use as a modifier in user facets This unlocks the entry into a function

<ExpandableCode language="solidity" maxLines={8}>
{`function enter() ;`}
</ExpandableCode>

---
### exit

This locks the entry into a function

<ExpandableCode language="solidity" maxLines={8}>
{`function exit() ;`}
</ExpandableCode>

## Errors

<AccordionGroup>
  <Accordion title="Reentrancy" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Function selector - 0x43a0d067
    </div>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error Reentrancy();
      </ExpandableCode>
    </div>
  </Accordion>
</AccordionGroup>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {NonReentrancyMod} from \"@compose/libraries/NonReentrancyMod\";

contract MyFacet {
    using NonReentrancyMod for uint256; // Dummy type, library functions are standalone

    function doSomethingSensitive() external {
        NonReentrancyMod.enter();
        try {
            // ... perform sensitive operations ...
        } finally {
            NonReentrancyMod.exit();
        }
    }

    function anotherSensitiveAction() external {
        NonReentrancyMod.enter();
        // ... other sensitive operations ...
        NonReentrancyMod.exit();
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Always pair `NonReentrancyMod.enter()` with `NonReentrancyMod.exit()` in a `try...finally` block to ensure the lock is released, even if errors occur.
- Use this library for any function that modifies critical state and could potentially be called recursively from within itself or another function.
</Callout>

## Integration Notes

<Callout type="success" title="Shared Storage">
The `NonReentrancyMod` library does not interact with diamond storage. Its state is managed internally within the EVM execution context. Facets using this library will manage their own reentrancy protection state independently of the diamond's core storage layout.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="NonReentrancyMod" />
</div>

<LastUpdated date="2025-12-30T15:39:51.365Z" />
