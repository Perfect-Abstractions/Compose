---
sidebar_position: 410
title: "ERC165Facet"
description: "Implements ERC-165 standard for interface detection."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/interfaceDetection/ERC165/ERC165Facet.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Implements ERC-165 standard for interface detection.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Implements the `supportsInterface` function as per ERC-165.
- Provides a standardized mechanism for interface detection within a diamond proxy.
</Callout>

## Overview

The ERC165Facet enables Compose diamonds to declare and query supported interfaces using the ERC-165 standard. This facet ensures interoperability by providing a standardized method for other contracts to discover the diamond's capabilities.

---

## Storage

### ERC165Storage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct ERC165Storage {
    /**
    * @notice Mapping of interface IDs to whether they are supported
    */
    mapping(bytes4 => bool) supportedInterfaces;
}`}
</ExpandableCode>

### State Variables

<PropertyTable
  properties={[
    {
      name: "STORAGE_POSITION",
      type: "bytes32",
      description: "Diamond storage slot position for this module (Value: `keccak256(\"compose.erc165\")`)"
    }
  ]}
  showRequired={false}
/>

## Functions

### supportsInterface

Query if a contract implements an interface This function checks if the diamond supports the given interface ID

<ExpandableCode language="solidity" maxLines={8}>
{`function supportsInterface(bytes4 _interfaceId) external view returns (bool);`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_interfaceId",
      type: "bytes4",
      description: "The interface identifier, as specified in ERC-165"
    }
  ]}
  showRequired={false}
/>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "bool",
      description: "`true` if the contract implements `_interfaceId` and `_interfaceId` is not 0xffffffff, `false` otherwise"
    }
  ]}
  showRequired={false}
/>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import { IDiamondCut } from "@compose/diamond/IDiamondCut.sol";
import { ERC165Facet } from "@compose/interfaceDetection/ERC165/ERC165Facet.sol";

contract MyDiamond is IDiamondCut {
    // ... other facet and diamond setup ...

    function supportsInterface(bytes4 _interfaceId) external view override returns (bool) {
        // Delegate to the ERC165Facet
        return ERC165Facet.supportsInterface(_interfaceId);
    }

    // ... other diamond functions ...
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Ensure the ERC165Facet is included in the diamond's initial deployment or upgrade.
- When implementing custom interfaces, ensure their IDs are correctly registered within the ERC165Facet's logic (typically via the ERC165Mod).
- Call `supportsInterface` from external contracts to determine if a diamond or its facets implement specific functionality.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
This facet primarily handles interface detection and does not manage critical state or complex logic, thus posing minimal reentrancy or direct state manipulation risks. Ensure that the interface IDs registered within the facet accurately reflect the diamond's capabilities.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ERC165Mod",
        href: "/docs/library/interfaceDetection/ERC165/ERC165Mod",
        description: "Module used by ERC165Facet",
        icon: "ðŸ“¦"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ERC165Facet" />
</div>

<LastUpdated date="2025-12-30T15:39:22.709Z" />
