---
sidebar_position: 99
title: "AccessControlPausableFacet"
description: "Manage roles and pausing functionality for diamond access control."
gitSource: "https://github.com/maxnorm/Compose/blob/75e2e68f9cd44e6a24767abe937e3f91886c823f/src/access/AccessControlPausable/AccessControlPausableFacet.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Manage roles and pausing functionality for diamond access control.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Role-specific pausing: Allows individual roles to be paused independently.
- Admin-controlled pausing: Only the designated admin of a role can pause or unpause it.
- Integrated access control checks: `requireRoleNotPaused` enforces role activity.
</Callout>

## Overview

This facet provides granular control over role-based access and allows for temporary pausing of specific roles. It integrates with the diamond's storage to manage role states and enforce pausing conditions, ensuring that only authorized actions can be performed when a role is active.

---

## Storage

### AccessControlStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct AccessControlStorage {
    mapping(address account => mapping(bytes32 role => bool hasRole)) hasRole;
    mapping(bytes32 role => bytes32 adminRole) adminRole;
}`}
</ExpandableCode>

---
### AccessControlPausableStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct AccessControlPausableStorage {
    mapping(bytes32 role => bool paused) pausedRoles;
}`}
</ExpandableCode>

### State Variables

<PropertyTable
  properties={[
    {
      name: "ACCESS_CONTROL_STORAGE_POSITION",
      type: "constant",
      description: "Diamond storage slot position for this module"
    },
    {
      name: "PAUSABLE_STORAGE_POSITION",
      type: "constant",
      description: "Diamond storage slot position for this module"
    }
  ]}
  showRequired={false}
/>

## Functions

### getAccessControlStorage

Returns the storage for AccessControl.

<ExpandableCode language="solidity" maxLines={8}>
{`function getAccessControlStorage() internal pure returns (AccessControlStorage storage s);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "s",
      type: "AccessControlStorage",
      description: "The AccessControl storage struct."
    }
  ]}
  showRequired={false}
/>

---
### getStorage

Returns the storage for AccessControlPausable.

<ExpandableCode language="solidity" maxLines={8}>
{`function getStorage() internal pure returns (AccessControlPausableStorage storage s);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "s",
      type: "AccessControlPausableStorage",
      description: "The AccessControlPausable storage struct."
    }
  ]}
  showRequired={false}
/>

---
### isRolePaused

Returns if a role is paused.

<ExpandableCode language="solidity" maxLines={8}>
{`function isRolePaused(bytes32 _role) external view returns (bool);`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_role",
      type: "bytes32",
      description: "The role to check."
    }
  ]}
  showRequired={false}
/>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "bool",
      description: "True if the role is paused, false otherwise."
    }
  ]}
  showRequired={false}
/>

---
### pauseRole

Temporarily disables a role, preventing all accounts from using it. Only the admin of the role can pause it. Emits a RolePaused event. Reverts with AccessControlUnauthorizedAccount If the caller is not the admin of the role.

<ExpandableCode language="solidity" maxLines={8}>
{`function pauseRole(bytes32 _role) external;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_role",
      type: "bytes32",
      description: "The role to pause."
    }
  ]}
  showRequired={false}
/>

---
### unpauseRole

Re-enables a role that was previously paused. Only the admin of the role can unpause it. Emits a RoleUnpaused event. Reverts with AccessControlUnauthorizedAccount If the caller is not the admin of the role.

<ExpandableCode language="solidity" maxLines={8}>
{`function unpauseRole(bytes32 _role) external;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_role",
      type: "bytes32",
      description: "The role to unpause."
    }
  ]}
  showRequired={false}
/>

---
### requireRoleNotPaused

Checks if an account has a role and if the role is not paused. - Reverts with AccessControlUnauthorizedAccount If the account does not have the role. - Reverts with AccessControlRolePaused If the role is paused.

<ExpandableCode language="solidity" maxLines={8}>
{`function requireRoleNotPaused(bytes32 _role, address _account) external view;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_role",
      type: "bytes32",
      description: "The role to check."
    },
    {
      name: "_account",
      type: "address",
      description: "The account to check the role for."
    }
  ]}
  showRequired={false}
/>

## Events

<AccordionGroup>
  <Accordion title="RolePaused" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Event emitted when a role is paused.
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event RolePaused(bytes32 indexed _role, address indexed _account);`}
      </ExpandableCode>
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Parameters:</strong>
      <PropertyTable
        properties={[
          {
            name: "_role",
            type: "bytes32",
            description: "The role that was paused."
          },
          {
            name: "_account",
            type: "address",
            description: "The account that paused the role."
          }
        ]}
        showRequired={false}
      />
    </div>
  </Accordion>
  <Accordion title="RoleUnpaused" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Event emitted when a role is unpaused.
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event RoleUnpaused(bytes32 indexed _role, address indexed _account);`}
      </ExpandableCode>
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Parameters:</strong>
      <PropertyTable
        properties={[
          {
            name: "_role",
            type: "bytes32",
            description: "The role that was unpaused."
          },
          {
            name: "_account",
            type: "address",
            description: "The account that unpaused the role."
          }
        ]}
        showRequired={false}
      />
    </div>
  </Accordion>
</AccordionGroup>

## Errors

<AccordionGroup>
  <Accordion title="AccessControlUnauthorizedAccount" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Thrown when the account does not have a specific role.
    </div>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error AccessControlUnauthorizedAccount(address _account, bytes32 _role);
      </ExpandableCode>
    </div>
  </Accordion>
  <Accordion title="AccessControlRolePaused" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Thrown when a role is paused and an operation requiring that role is attempted.
    </div>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error AccessControlRolePaused(bytes32 _role);
      </ExpandableCode>
    </div>
  </Accordion>
</AccordionGroup>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IComposeDiamond} from "@compose-protocol/diamond-contracts/contracts/interfaces/IComposeDiamond.sol";
import {AccessControlPausableFacet} from "@compose-protocol/diamond-contracts/contracts/facets/AccessControlPausableFacet.sol";

contract Deployer {
    address diamondAddress;

    function deploy() external {
        // Assume diamondAddress is already set or deployed
        diamondAddress = address(1); // Placeholder

        // Add AccessControlPausableFacet to the diamond
        // Function selectors for AccessControlPausableFacet
        bytes4[] memory selectors = new bytes4[](7);
        selectors[0] = AccessControlPausableFacet.getAccessControlStorage.selector;
        selectors[1] = AccessControlPausableFacet.getStorage.selector;
        selectors[2] = AccessControlPausableFacet.isRolePaused.selector;
        selectors[3] = AccessControlPausableFacet.pauseRole.selector;
        selectors[4] = AccessControlPausableFacet.unpauseRole.selector;
        selectors[5] = AccessControlPausableFacet.requireRoleNotPaused.selector;
        // Add other selectors if needed, e.g., grantRole, revokeRole from AccessControl facet

        IComposeDiamond(diamondAddress).diamondCut(
            new IComposeDiamond.FacetCut[]{
                (AccessControlPausableFacet.attach(address(0)), IComposeDiamond.FacetCutAction.Add, selectors)
            },
            address(0), // target init contract
            bytes("") // init data
        );
    }

    function pauseMyRole() external {
        address accessControlPausableFacetAddress = IComposeDiamond(diamondAddress).getFacetAddress(AccessControlPausableFacet.getStorage.selector);
        bytes32 role = keccak256("MY_ROLE"); // Example role
        AccessControlPausableFacet(accessControlPausableFacetAddress).pauseRole(role);
    }

    function unpauseMyRole() external {
        address accessControlPausableFacetAddress = IComposeDiamond(diamondAddress).getFacetAddress(AccessControlPausableFacet.getStorage.selector);
        bytes32 role = keccak256("MY_ROLE"); // Example role
        AccessControlPausableFacet(accessControlPausableFacetAddress).unpauseRole(role);
    }

    function checkRoleStatus() external view returns (bool) {
        address accessControlPausableFacetAddress = IComposeDiamond(diamondAddress).getFacetAddress(AccessControlPausableFacet.getStorage.selector);
        bytes32 role = keccak256("MY_ROLE"); // Example role
        return AccessControlPausableFacet(accessControlPausableFacetAddress).isRolePaused(role);
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Ensure the `AccessControlFacet` is also deployed and configured for role management before using this facet for pausing.
- The `pauseRole` and `unpauseRole` functions require the caller to be the admin of the role, so proper role administration is crucial.
- Use `requireRoleNotPaused` within other facets to enforce role availability before executing sensitive operations.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Access control relies on the underlying AccessControl system correctly assigning role admins. Incorrect admin assignment could lead to unauthorized pausing or unpausing. The `requireRoleNotPaused` function prevents execution if a role is paused, mitigating risks associated with operations that should not occur during a pause. Ensure that the caller has the necessary permissions to call `pauseRole` and `unpauseRole` to prevent unauthorized state changes.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="AccessControlPausableFacet" />
</div>

<LastUpdated date="2025-12-21T20:53:35.802Z" />
