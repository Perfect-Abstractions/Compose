---
sidebar_position: 99
title: "OwnerTwoStepsFacet"
description: "Manages contract ownership with a two-step transfer process."
gitSource: "https://github.com/maxnorm/Compose/blob/2dfa9eb69851162421010a7e56bd0fa891a9311a/src/access/OwnerTwoSteps/OwnerTwoStepsFacet.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Manages contract ownership with a two-step transfer process.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Two-step ownership transfer: requires initiation and acceptance.
- `renounceOwnership` allows for relinquishing ownership.
- Provides direct access to owner and pending owner addresses.
</Callout>

## Overview

The OwnerTwoStepsFacet provides a secure, two-step ownership transfer mechanism for Compose diamonds. It ensures that ownership changes are deliberate by requiring both the current owner to initiate a transfer and the new owner to accept it, preventing accidental or malicious takeovers.

---

## Storage

### OwnerStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct OwnerStorage {
    address owner;
}`}
</ExpandableCode>

---
### PendingOwnerStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct PendingOwnerStorage {
    address pendingOwner;
}`}
</ExpandableCode>

### State Variables

<PropertyTable
  properties={[
    {
      name: "OWNER_STORAGE_POSITION",
      type: "constant",
      description: "Diamond storage slot position for this module"
    },
    {
      name: "PENDING_OWNER_STORAGE_POSITION",
      type: "constant",
      description: "Diamond storage slot position for this module"
    }
  ]}
  showRequired={false}
/>

## Functions

### getOwnerStorage

Returns a pointer to the Owner storage struct. Uses inline assembly to access the storage slot defined by OWNER_STORAGE_POSITION.

<ExpandableCode language="solidity" maxLines={8}>
{`function getOwnerStorage() internal pure returns (OwnerStorage storage s);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "s",
      type: "OwnerStorage",
      description: "The OwnerStorage struct in storage."
    }
  ]}
  showRequired={false}
/>

---
### getPendingOwnerStorage

Returns a pointer to the PendingOwner storage struct. Uses inline assembly to access the storage slot defined by PENDING_OWNER_STORAGE_POSITION.

<ExpandableCode language="solidity" maxLines={8}>
{`function getPendingOwnerStorage() internal pure returns (PendingOwnerStorage storage s);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "s",
      type: "PendingOwnerStorage",
      description: "The PendingOwnerStorage struct in storage."
    }
  ]}
  showRequired={false}
/>

---
### owner

Get the address of the owner

<ExpandableCode language="solidity" maxLines={8}>
{`function owner() external view returns (address);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "address",
      description: "The address of the owner."
    }
  ]}
  showRequired={false}
/>

---
### pendingOwner

Get the address of the pending owner

<ExpandableCode language="solidity" maxLines={8}>
{`function pendingOwner() external view returns (address);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "address",
      description: "The address of the pending owner."
    }
  ]}
  showRequired={false}
/>

---
### transferOwnership

Set the address of the new owner of the contract

<ExpandableCode language="solidity" maxLines={8}>
{`function transferOwnership(address _newOwner) external;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_newOwner",
      type: "address",
      description: "The address of the new owner of the contract"
    }
  ]}
  showRequired={false}
/>

---
### acceptOwnership

<ExpandableCode language="solidity" maxLines={8}>
{`function acceptOwnership() external;`}
</ExpandableCode>

---
### renounceOwnership

<ExpandableCode language="solidity" maxLines={8}>
{`function renounceOwnership() external;`}
</ExpandableCode>

## Events

<AccordionGroup>
  <Accordion title="OwnershipTransferStarted" defaultOpen={false}>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferStarted(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
  <Accordion title="OwnershipTransferred" defaultOpen={false}>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferred(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
</AccordionGroup>

## Errors

<AccordionGroup>
  <Accordion title="OwnerUnauthorizedAccount" defaultOpen={false}>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error OwnerUnauthorizedAccount();
      </ExpandableCode>
    </div>
  </Accordion>
</AccordionGroup>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IOwnerTwoStepsFacet} from "@compose/core/src/facets/ownership/IOwnerTwoStepsFacet.sol";

contract Diamond {
    IOwnerTwoStepsFacet ownerFacet;

    function setOwnerFacet(address _facetAddress) external {
        ownerFacet = IOwnerTwoStepsFacet(_facetAddress);
    }

    // Example of initiating an ownership transfer
    function initiateOwnershipTransfer(address _newOwner) external {
        // Assuming Diamond contract has an access control mechanism for this function
        ownerFacet.transferOwnership(_newOwner);
    }

    // Example of accepting ownership transfer (would be called by the new owner)
    function acceptOwnershipTransfer() external {
        ownerFacet.acceptOwnership();
    }

    function getOwner() external view returns (address) {
        return ownerFacet.owner();
    }

    function getPendingOwner() external view returns (address) {
        return ownerFacet.pendingOwner();
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the facet with the current owner address during deployment.
- Ensure only the current owner can call `transferOwnership` and `renounceOwnership`.
- The pending owner must call `acceptOwnership` to finalize the transfer.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Access control is critical. The `transferOwnership` function must be restricted to the current owner. The `acceptOwnership` function is intended to be called by the proposed new owner. `renounceOwnership` should also be restricted to the current owner. Incorrect access control could lead to unauthorized ownership changes. No reentrancy concerns as state changes are atomic and do not call external contracts.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="OwnerTwoStepsFacet" />
</div>

<LastUpdated date="2025-12-21T21:43:21.344Z" />
