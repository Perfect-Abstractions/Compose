---
sidebar_position: 2
title: "OwnerTwoStepsFacet"
description: "Manage diamond ownership with a two-step transfer process."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/access/OwnerTwoSteps/OwnerTwoStepsFacet.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Manage diamond ownership with a two-step transfer process.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Secure two-step ownership transfer process (`transferOwnership` and `acceptOwnership`).
- Allows for ownership renouncement, making the contract ownerless.
- Provides view functions (`owner`, `pendingOwner`) to check current and pending ownership.
</Callout>

## Overview

The OwnerTwoSteps facet provides a secure, two-step mechanism for transferring ownership of a Compose diamond. This pattern prevents accidental or malicious ownership changes by requiring both the current owner to initiate the transfer and the new owner to accept it, enhancing the diamond's security and operational integrity.

---

## Storage

### OwnerStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct OwnerStorage {
    address owner;
}`}
</ExpandableCode>

---
### PendingOwnerStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct PendingOwnerStorage {
    address pendingOwner;
}`}
</ExpandableCode>

### State Variables

<PropertyTable
  properties={[
    {
      name: "OWNER_STORAGE_POSITION",
      type: "bytes32",
      description: "Diamond storage slot position for this module (Value: `keccak256(\"compose.owner\")`)"
    },
    {
      name: "PENDING_OWNER_STORAGE_POSITION",
      type: "bytes32",
      description: "Diamond storage slot position for this module (Value: `keccak256(\"compose.owner.pending\")`)"
    }
  ]}
  showRequired={false}
/>

## Functions

### owner

Get the address of the owner

<ExpandableCode language="solidity" maxLines={8}>
{`function owner() external view returns (address);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "address",
      description: "The address of the owner."
    }
  ]}
  showRequired={false}
/>

---
### pendingOwner

Get the address of the pending owner

<ExpandableCode language="solidity" maxLines={8}>
{`function pendingOwner() external view returns (address);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "address",
      description: "The address of the pending owner."
    }
  ]}
  showRequired={false}
/>

---
### transferOwnership

Set the address of the new owner of the contract

<ExpandableCode language="solidity" maxLines={8}>
{`function transferOwnership(address _newOwner) external;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_newOwner",
      type: "address",
      description: "The address of the new owner of the contract"
    }
  ]}
  showRequired={false}
/>

---
### acceptOwnership

<ExpandableCode language="solidity" maxLines={8}>
{`function acceptOwnership() external;`}
</ExpandableCode>

---
### renounceOwnership

<ExpandableCode language="solidity" maxLines={8}>
{`function renounceOwnership() external;`}
</ExpandableCode>

## Events

<AccordionGroup>
  <Accordion title="OwnershipTransferStarted" defaultOpen={false}>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferStarted(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
  <Accordion title="OwnershipTransferred" defaultOpen={false}>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferred(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
</AccordionGroup>

## Errors

<AccordionGroup>
  <Accordion title="OwnerUnauthorizedAccount" defaultOpen={false}>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error OwnerUnauthorizedAccount();
      </ExpandableCode>
    </div>
  </Accordion>
</AccordionGroup>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IOwnerTwoStepsFacet} from "@compose/access/OwnerTwoSteps/IOwnerTwoStepsFacet.sol";
import {OwnerTwoStepsFacet} from "@compose/access/OwnerTwoSteps/OwnerTwoStepsFacet.sol";

// Assume diamond deployment and initialization context

contract DiamondOwnerDeployer {
    address public diamondAddress;

    function deployDiamondWithOwner() external {
        // ... diamond deployment logic ...
        // diamondAddress = deployedDiamond;

        // Add OwnerTwoStepsFacet to the diamond
        // ... facet registration logic ...

        // Initialize the facet
        IOwnerTwoStepsFacet(diamondAddress).transferOwnership(msg.sender); // Or an admin address
    }

    function acceptDiamondOwnership() external {
        // Call from the pending owner
        IOwnerTwoStepsFacet(diamondAddress).acceptOwnership();
    }

    function renounceDiamondOwnership() external {
        // Call from the current owner to renounce ownership
        IOwnerTwoStepsFacet(diamondAddress).renounceOwnership();
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize ownership transfers using `transferOwnership` from an authorized address.
- Ensure the intended new owner calls `acceptOwnership` to finalize the transfer.
- Use `renounceOwnership` cautiously, as it makes the diamond contract unownable.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Access to `transferOwnership` and `renounceOwnership` is restricted to the current owner. `acceptOwnership` can only be called by the address designated as the pending owner. Ensure that the address initiating `transferOwnership` is indeed the legitimate owner to prevent unauthorized ownership changes. Accidental renouncement will render the contract unmanageable by any address.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="OwnerTwoStepsFacet" />
</div>

<LastUpdated date="2025-12-30T15:53:48.922Z" />
