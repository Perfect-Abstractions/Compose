---
sidebar_position: 99
title: "OwnerTwoStepsFacet"
description: "Manages contract ownership with a two-step transfer process."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/access/OwnerTwoSteps/OwnerTwoStepsFacet.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Manages contract ownership with a two-step transfer process.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Two-step ownership transfer process for enhanced security.
- Explicit `acceptOwnership` call by the new owner.
- `renounceOwnership` function to remove ownership.
- Direct storage access via inline assembly for efficiency.
</Callout>

## Overview

This facet provides a secure, two-step ownership transfer mechanism, preventing accidental or malicious takeover of the diamond. It allows the current owner to initiate a transfer and requires the new owner to accept it, ensuring explicit confirmation.

---

## Storage

### OwnerStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct OwnerStorage {
    address owner;
}`}
</ExpandableCode>

---
### PendingOwnerStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct PendingOwnerStorage {
    address pendingOwner;
}`}
</ExpandableCode>

### State Variables

<PropertyTable
  properties={[
    {
      name: "OWNER_STORAGE_POSITION",
      type: "constant",
      description: "Diamond storage slot position for this module"
    },
    {
      name: "PENDING_OWNER_STORAGE_POSITION",
      type: "constant",
      description: "Diamond storage slot position for this module"
    }
  ]}
  showRequired={false}
/>

## Functions

### owner

Get the address of the owner

<ExpandableCode language="solidity" maxLines={8}>
{`function owner() external view returns (address);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "address",
      description: "The address of the owner."
    }
  ]}
  showRequired={false}
/>

---
### pendingOwner

Get the address of the pending owner

<ExpandableCode language="solidity" maxLines={8}>
{`function pendingOwner() external view returns (address);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "address",
      description: "The address of the pending owner."
    }
  ]}
  showRequired={false}
/>

---
### transferOwnership

Set the address of the new owner of the contract

<ExpandableCode language="solidity" maxLines={8}>
{`function transferOwnership(address _newOwner) external;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_newOwner",
      type: "address",
      description: "The address of the new owner of the contract"
    }
  ]}
  showRequired={false}
/>

---
### acceptOwnership

<ExpandableCode language="solidity" maxLines={8}>
{`function acceptOwnership() external;`}
</ExpandableCode>

---
### renounceOwnership

<ExpandableCode language="solidity" maxLines={8}>
{`function renounceOwnership() external;`}
</ExpandableCode>

## Events

<AccordionGroup>
  <Accordion title="OwnershipTransferStarted" defaultOpen={false}>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferStarted(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
  <Accordion title="OwnershipTransferred" defaultOpen={false}>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferred(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
</AccordionGroup>

## Errors

<AccordionGroup>
  <Accordion title="OwnerUnauthorizedAccount" defaultOpen={false}>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error OwnerUnauthorizedAccount();
      </ExpandableCode>
    </div>
  </Accordion>
</AccordionGroup>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IOwnerTwoStepsFacet} from "@compose/contracts/src/facets/owner/IOwnerTwoStepsFacet.sol";

contract OwnerConsumer {
    IOwnerTwoStepsFacet public ownerFacet;

    constructor(address _ownerFacetAddress) {
        ownerFacet = IOwnerTwoStepsFacet(_ownerFacetAddress);
    }

    function initiateOwnershipTransfer(address _newOwner) external {
        // Assumes caller is the current owner
        ownerFacet.transferOwnership(_newOwner);
    }

    function acceptNewOwnership() external {
        // Assumes caller is the pending owner
        ownerFacet.acceptOwnership();
    }

    function renounceContractOwnership() external {
        // Assumes caller is the current owner
        ownerFacet.renounceOwnership();
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Only the current owner should call `transferOwnership` and `renounceOwnership`.
- Only the pending owner should call `acceptOwnership`.
- Store the `OWNER_STORAGE_POSITION` and `PENDING_OWNER_STORAGE_POSITION` constants securely and ensure they are correctly set during deployment.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Ensure that the `transferOwnership` function is only callable by the current owner. The `acceptOwnership` function must only be callable by the pending owner. Incorrect access control could lead to unauthorized ownership changes. The inline assembly for storage access relies on the correct definition and immutability of `OWNER_STORAGE_POSITION` and `PENDING_OWNER_STORAGE_POSITION`; any change to these slots could break ownership management.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="OwnerTwoStepsFacet" />
</div>

<LastUpdated date="2025-12-23T00:00:06.959Z" />
