---
sidebar_position: 2
title: "OwnerTwoStepsFacet"
description: "Manages diamond ownership with two-step transfer and renounce"
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/access/OwnerTwoSteps/OwnerTwoStepsFacet.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Manages diamond ownership with two-step transfer and renounce
</DocSubtitle>

<Callout type="info" title="Key Features">
- Implements a secure two-step ownership transfer process.
- Exposes owner and pending owner status via external view functions.
- Functions are routed through the diamond proxy, adhering to EIP-2535.
- Minimal dependencies, designed for composability within a diamond.
</Callout>

## Overview

This facet implements a two-step ownership transfer mechanism for a diamond, providing enhanced security. It exposes external functions to manage the owner and pending owner addresses, accessible through the diamond proxy. Developers integrate this facet to control administrative functions within the diamond, requiring explicit acceptance of ownership transfers.

---

## Storage

### OwnerStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct OwnerStorage {
    address owner;
}`}
</ExpandableCode>

---
### PendingOwnerStorage

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct PendingOwnerStorage {
    address pendingOwner;
}`}
</ExpandableCode>

### State Variables

<PropertyTable
  properties={[
    {
      name: "OWNER_STORAGE_POSITION",
      type: "bytes32",
      description: "Diamond storage slot position for this module (Value: `keccak256(\"compose.owner\")`)"
    },
    {
      name: "PENDING_OWNER_STORAGE_POSITION",
      type: "bytes32",
      description: "Diamond storage slot position for this module (Value: `keccak256(\"compose.owner.pending\")`)"
    }
  ]}
  showRequired={false}
/>

## Functions

### owner

Get the address of the owner

<ExpandableCode language="solidity" maxLines={8}>
{`function owner() external view returns (address);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "address",
      description: "The address of the owner."
    }
  ]}
  showRequired={false}
/>

---
### pendingOwner

Get the address of the pending owner

<ExpandableCode language="solidity" maxLines={8}>
{`function pendingOwner() external view returns (address);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "-",
      type: "address",
      description: "The address of the pending owner."
    }
  ]}
  showRequired={false}
/>

---
### transferOwnership

Set the address of the new owner of the contract

<ExpandableCode language="solidity" maxLines={8}>
{`function transferOwnership(address _newOwner) external;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_newOwner",
      type: "address",
      description: "The address of the new owner of the contract"
    }
  ]}
  showRequired={false}
/>

---
### acceptOwnership

<ExpandableCode language="solidity" maxLines={8}>
{`function acceptOwnership() external;`}
</ExpandableCode>

---
### renounceOwnership

<ExpandableCode language="solidity" maxLines={8}>
{`function renounceOwnership() external;`}
</ExpandableCode>

## Events

<AccordionGroup>
  <Accordion title="OwnershipTransferStarted" defaultOpen={false}>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferStarted(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
  <Accordion title="OwnershipTransferred" defaultOpen={false}>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferred(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
</AccordionGroup>

## Errors

<AccordionGroup>
  <Accordion title="OwnerUnauthorizedAccount" defaultOpen={false}>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error OwnerUnauthorizedAccount();
      </ExpandableCode>
    </div>
  </Accordion>
</AccordionGroup>

<!-- Usage Example section commented out for now -->
<!--
## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity >=0.8.30;
import {IDiamond} from "@compose/diamond/IDiamond";
import {OwnerTwoStepsFacet} from "@compose/access/OwnerTwoSteps/OwnerTwoStepsFacet";

contract DiamondUser {
    address public diamondAddress;

    constructor(address _diamondAddress) {
        diamondAddress = _diamondAddress;
    }

    /**
     * @notice Initiates an ownership transfer through the diamond.
     * @param _newOwner The address to transfer ownership to.
     */
    function requestOwnershipTransfer(address _newOwner) external {
        IDiamond(diamondAddress).transferOwnership(_newOwner);
    }

    /**
     * @notice Accepts a pending ownership transfer through the diamond.
     */
    function acceptNewOwnership() external {
        IDiamond(diamondAddress).acceptOwnership();
    }

    /**
     * @notice Renounces ownership of the diamond.
     */
    function renounceDiamondOwnership() external {
        IDiamond(diamondAddress).renounceOwnership();
    }

    /**
     * @notice Gets the current owner of the diamond.
     * @return The address of the current owner.
     */
    function getCurrentOwner() external view returns (address) {
        return IDiamond(diamondAddress).owner();
    }

    /**
     * @notice Gets the pending owner of the diamond.
     * @return The address of the pending owner.
     */
    function getPendingOwner() external view returns (address) {
        return IDiamond(diamondAddress).pendingOwner();
    }
}
`}
</ExpandableCode>
-->

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the owner address during the diamond's deployment process.
- Call `transferOwnership` to initiate a transfer, followed by `acceptOwnership` from the new address.
- Utilize `renounceOwnership` to remove the owner role when no longer needed.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The `transferOwnership` function requires the caller to be the current owner. The `acceptOwnership` function can only be called by the pending owner. `renounceOwnership` can only be called by the current owner. All sensitive operations are protected by these access controls. The `OwnerUnauthorizedAccount` error is emitted if unauthorized calls are attempted. Follow standard Solidity security practices for input validation.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="OwnerTwoStepsFacet" />
</div>

<LastUpdated date="2025-12-30T17:27:01.049Z" />
