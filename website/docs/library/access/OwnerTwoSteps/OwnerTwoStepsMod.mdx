---
sidebar_position: 1
title: "OwnerTwoStepsMod"
description: "Two-step ownership transfer for contracts"
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/access/OwnerTwoSteps/OwnerTwoStepsMod.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Two-step ownership transfer for contracts
</DocSubtitle>

<Callout type="info" title="Key Features">
- Implements ERC-173 two-step ownership transfer.
- All functions are `internal` or `external` for direct facet integration.
- Uses diamond storage for ownership state.
- Provides `owner()` and `pendingOwner()` view functions.
</Callout>

<Callout type="info" title="Module Usage">
This module provides internal functions for use in your custom facets. Import it to access shared logic and storage.
</Callout>

## Overview

This module provides a secure two-step ownership transfer mechanism. Facets can import this module to manage contract ownership, ensuring that ownership changes require explicit acceptance by the new owner. This pattern minimizes the risk of accidental ownership loss or unauthorized transfers.

---

## Storage

### OwnerStorage

storage-location: erc8042:compose.owner

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct OwnerStorage {
    address owner;
}`}
</ExpandableCode>

---
### PendingOwnerStorage

storage-location: erc8042:compose.owner.pending

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct PendingOwnerStorage {
    address pendingOwner;
}`}
</ExpandableCode>

### State Variables

<PropertyTable
  properties={[
    {
      name: "OWNER_STORAGE_POSITION",
      type: "bytes32",
      description: "Diamond storage slot position for this module (Value: `keccak256(\"compose.owner\")`)"
    },
    {
      name: "PENDING_OWNER_STORAGE_POSITION",
      type: "bytes32",
      description: "Diamond storage slot position for this module (Value: `keccak256(\"compose.owner.pending\")`)"
    }
  ]}
  showRequired={false}
/>

## Functions

### acceptOwnership

Finalizes ownership transfer; must be called by the pending owner.

<ExpandableCode language="solidity" maxLines={8}>
{`function acceptOwnership() ;`}
</ExpandableCode>

---
### getOwnerStorage

Returns a pointer to the Owner storage struct. Uses inline assembly to access the storage slot defined by OWNER_STORAGE_POSITION.

<ExpandableCode language="solidity" maxLines={8}>
{`function getOwnerStorage() pure returns (OwnerStorage storage s);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "s",
      type: "OwnerStorage",
      description: "The OwnerStorage struct in storage."
    }
  ]}
  showRequired={false}
/>

---
### getPendingOwnerStorage

Returns a pointer to the PendingOwner storage struct. Uses inline assembly to access the storage slot defined by PENDING_OWNER_STORAGE_POSITION.

<ExpandableCode language="solidity" maxLines={8}>
{`function getPendingOwnerStorage() pure returns (PendingOwnerStorage storage s);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "s",
      type: "PendingOwnerStorage",
      description: "The PendingOwnerStorage struct in storage."
    }
  ]}
  showRequired={false}
/>

---
### owner

Returns the current owner.

<ExpandableCode language="solidity" maxLines={8}>
{`function owner() view returns (address);`}
</ExpandableCode>

---
### pendingOwner

Returns the pending owner (if any).

<ExpandableCode language="solidity" maxLines={8}>
{`function pendingOwner() view returns (address);`}
</ExpandableCode>

---
### renounceOwnership

Renounce ownership of the contract Sets the owner to address(0), disabling all functions restricted to the owner.

<ExpandableCode language="solidity" maxLines={8}>
{`function renounceOwnership() ;`}
</ExpandableCode>

---
### requireOwner

Reverts if the caller is not the owner.

<ExpandableCode language="solidity" maxLines={8}>
{`function requireOwner() view;`}
</ExpandableCode>

---
### transferOwnership

Initiates a two-step ownership transfer.

<ExpandableCode language="solidity" maxLines={8}>
{`function transferOwnership(address _newOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_newOwner",
      type: "address",
      description: "The address of the new owner of the contract"
    }
  ]}
  showRequired={false}
/>

## Events

<AccordionGroup>
  <Accordion title="OwnershipTransferStarted" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Emitted when ownership transfer is initiated (pending owner set).
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferStarted(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
  <Accordion title="OwnershipTransferred" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Emitted when ownership transfer is finalized.
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event OwnershipTransferred(address indexed _previousOwner, address indexed _newOwner);`}
      </ExpandableCode>
    </div>

  </Accordion>
</AccordionGroup>

## Errors

<AccordionGroup>
  <Accordion title="OwnerAlreadyRenounced" defaultOpen={false}>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error OwnerAlreadyRenounced();
      </ExpandableCode>
    </div>
  </Accordion>
  <Accordion title="OwnerUnauthorizedAccount" defaultOpen={false}>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error OwnerUnauthorizedAccount();
      </ExpandableCode>
    </div>
  </Accordion>
</AccordionGroup>

<!-- Usage Example section commented out for now -->
<!--
## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity >=0.8.30;

import {OwnerTwoStepsMod} from "@compose/access/OwnerTwoSteps/OwnerTwoStepsMod";

contract OwnerFacet {
    OwnerTwoStepsMod internal ownerMod;

    constructor(address ownerModAddress) {
        ownerMod = OwnerTwoStepsMod(ownerModAddress);
    }

    /**
     * @notice Initiates an ownership transfer.
     * @param _newOwner The address to transfer ownership to.
     */
    function initiateOwnershipTransfer(address _newOwner) external {
        ownerMod.transferOwnership(_newOwner);
    }

    /**
     * @notice Accepts a pending ownership transfer.
     */
    function acceptOwnershipTransfer() external {
        ownerMod.acceptOwnership();
    }

    /**
     * @notice Renounces ownership of the contract.
     */
    function renounceContractOwnership() external {
        ownerMod.renounceOwnership();
    }

    /**
     * @notice Gets the current owner.
     * @return The current owner's address.
     */
    function getCurrentOwner() external view returns (address) {
        return ownerMod.owner();
    }

    /**
     * @notice Gets the pending owner.
     * @return The pending owner's address.
     */
    function getPendingOwner() external view returns (address) {
        return ownerMod.pendingOwner();
    }
}`}
</ExpandableCode>
-->

## Best Practices

<Callout type="tip" title="Best Practice">
- Call `transferOwnership` only from the current owner.
- Ensure `acceptOwnership` is called by the intended new owner.
- Handle `OwnerUnauthorizedAccount` and `OwnerAlreadyRenounced` errors appropriately.
</Callout>

## Integration Notes

<Callout type="success" title="Shared Storage">
This module manages ownership state within the diamond's storage. It uses `OWNER_STORAGE_POSITION` and `PENDING_OWNER_STORAGE_POSITION` to access its `OwnerStorage` and `PendingOwnerStorage` structs, respectively. Changes made via `transferOwnership`, `acceptOwnership`, and `renounceOwnership` are immediately reflected in the diamond's shared storage, visible to all facets.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "OwnerTwoStepsFacet",
        href: "/docs/library/access/OwnerTwoSteps/OwnerTwoStepsFacet",
        description: "Facet using OwnerTwoStepsMod",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="OwnerTwoStepsMod" />
</div>

<LastUpdated date="2025-12-30T18:49:21.458Z" />
