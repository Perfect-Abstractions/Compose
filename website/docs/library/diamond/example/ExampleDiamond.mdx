---
sidebar_position: 510
title: "ExampleDiamond"
description: "Manages facet registration and ownership for a diamond."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Manages facet registration and ownership for a diamond.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Initializes the diamond with a set of facets and their function selectors.
- Establishes the contract owner during deployment.
- Supports adding, replacing, or removing facets via the `FacetCut` struct.
</Callout>

## Overview

The ExampleDiamond facet acts as the core contract for a Compose diamond. It handles the initialization of the diamond by registering facets and their associated function selectors, enabling delegatecall routing. It also establishes the initial owner of the diamond, crucial for subsequent administrative operations.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IDiamondCut} from "@compose/diamond/contracts/IDiamondCut.sol";
import {ExampleDiamond} from "@compose/diamond/contracts/ExampleDiamond.sol";

contract DeployExampleDiamond {
    address public diamondAddress;

    function deploy() public {
        // Define facets to be added during initialization
        ExampleDiamond.FacetCut[] memory facetsToInit = new ExampleDiamond.FacetCut[](2);

        // Example facet 1 (replace with actual facet address and selectors)
        bytes4[] memory selectors1 = new bytes4[](1);
        selectors1[0] = ExampleDiamond.deploy.selector; // Example selector
        facetsToInit[0] = ExampleDiamond.FacetCut({
            facetAddress: address(this), // Placeholder address
            action: ExampleDiamond.FacetCutAction.Add,
            functionSelectors: selectors1
        });

        // Example facet 2 (replace with actual facet address and selectors)
        bytes4[] memory selectors2 = new bytes4[](1);
        selectors2[0] = ExampleDiamond.fallback.selector; // Example selector
        facetsToInit[1] = ExampleDiamond.FacetCut({
            facetAddress: address(this), // Placeholder address
            action: ExampleDiamond.FacetCutAction.Add,
            functionSelectors: selectors2
        });

        // Deploy the diamond, initializing it with facets and owner
        ExampleDiamond exampleDiamond = new ExampleDiamond();
        exampleDiamond.constructor(facetsToInit, msg.sender); // msg.sender becomes owner
        diamondAddress = address(exampleDiamond);
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Ensure all facets intended for initialization are correctly defined with their respective function selectors.
- The `msg.sender` at the time of diamond deployment becomes the initial owner, responsible for future upgrades and management.
- Carefully consider the initial set of facets to be registered; subsequent additions or modifications require diamond upgrade mechanisms.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
This facet is responsible for the initial setup and ownership of the diamond. Any vulnerabilities in the constructor logic or improper owner assignment could lead to the permanent loss of control over the diamond. Ensure the facet addresses and selectors provided during initialization are correct and trusted.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ExampleDiamond",
        href: "/docs/library/diamond/example/ExampleDiamond",
        description: "Module used by ExampleDiamond",
        icon: "ðŸ“¦"
      },
      {
        title: "DiamondInspectFacet",
        href: "/docs/library/diamond/DiamondInspectFacet",
        description: "Related facet in diamond",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-30T15:03:29.078Z" />
