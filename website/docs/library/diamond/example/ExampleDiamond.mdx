---
sidebar_position: 510
title: "ExampleDiamond"
description: "Example Diamond for Compose: Initializes and manages facets."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Example Diamond for Compose: Initializes and manages facets.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Initializes the diamond proxy with an owner and an initial set of facets.
- Registers function selectors to enable `delegatecall` routing to the correct facets.
- Demonstrates the fundamental structure for deploying a Compose diamond.
</Callout>

## Overview

The ExampleDiamond contract serves as a foundational example for Compose diamonds. It demonstrates the core initialization process, including setting the owner and registering facet function selectors. This contract is crucial for understanding how facets are added and made accessible through the diamond proxy pattern.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {ExampleDiamond} from "@compose/contracts/diamond/ExampleDiamond.sol";
import {DiamondCutFacet} from "@compose/contracts/diamond/facets/DiamondCutFacet.sol";
import {DiamondLoupeFacet} from "@compose/contracts/diamond/facets/DiamondLoupeFacet.sol";

contract MyDiamond is ExampleDiamond {
    constructor(address _owner, FacetCut[] memory _diamondCut) ExampleDiamond(_owner, _diamondCut) {
        // Additional diamond initialization logic can go here
    }

    // Fallback and receive functions are inherited and managed by ExampleDiamond
}

// Deployment example (conceptual)
// FacetCut[] memory facetsToCut = new FacetCut[](2);
// facetsToCut[0] = FacetCut(address(new DiamondCutFacet()), FacetCutAction.Add, DiamondCutFacet.getFunctionSelectors());
// facetsToCut[1] = FacetCut(address(new DiamondLoupeFacet()), FacetCutAction.Add, DiamondLoupeFacet.getFunctionSelectors());
//
// address owner = msg.sender;
// ExampleDiamond diamond = new ExampleDiamond(owner, facetsToCut);
`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond with essential facets like DiamondCutFacet and DiamondLoupeFacet during deployment.
- Ensure the owner is set correctly to manage future facet upgrades.
- Understand that `constructor` is used for initial setup; upgrades are handled via `DiamondCutFacet`.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The `constructor` is called only once during deployment. Access control for subsequent facet management is delegated to the `DiamondCutFacet`, which should be secured appropriately (e.g., restricted to the owner). The `fallback` and `receive` functions are inherited and their behavior is determined by the underlying diamond proxy implementation.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ExampleDiamond",
        href: "/docs/library/diamond/example/ExampleDiamond",
        description: "Module used by ExampleDiamond",
        icon: "ðŸ“¦"
      },
      {
        title: "DiamondInspectFacet",
        href: "/docs/library/diamond/DiamondInspectFacet",
        description: "Related facet in diamond",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-30T14:42:44.058Z" />
