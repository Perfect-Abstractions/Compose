---
sidebar_position: 510
title: "ExampleDiamond"
description: "Initializes and manages diamond facets and ownership."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Initializes and manages diamond facets and ownership.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Registers facets and their function selectors to enable diamond routing.
- Sets the initial owner of the diamond contract.
- Supports adding, replacing, or removing facets during initialization.
</Callout>

## Overview

The ExampleDiamond facet serves as the core initialization contract for a Compose diamond. It registers facets and their associated function selectors, enabling the diamond proxy to route calls to the correct implementation contracts. It also establishes the initial owner of the diamond.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IDiamondCut} from "@compose-protocol/diamond-contracts/contracts/interfaces/IDiamondCut.sol";
import {ExampleDiamond} from "@compose-protocol/diamond-contracts/contracts/facets/ExampleDiamond.sol";

contract Deployer {
    address owner = msg.sender;

    function deploy() public {
        // Example facet details
        address erc20FacetAddress = address(0x123); // Replace with actual ERC20 facet address
        bytes4[] memory erc20Selectors = new bytes4[](2);
        erc20Selectors[0] = ExampleDiamond.transfer.selector;
        erc20Selectors[1] = ExampleDiamond.balanceOf.selector;

        address governanceFacetAddress = address(0x456); // Replace with actual Governance facet address
        bytes4[] memory governanceSelectors = new bytes4[](1);
        governanceSelectors[0] = ExampleDiamond.setOwner.selector;

        // Setup FacetCuts
        IDiamondCut.FacetCut[] memory cuts = new IDiamondCut.FacetCut[](2);
        cuts[0] = IDiamondCut.FacetCut({
            facetAddress: erc20FacetAddress,
            action: IDiamondCut.FacetCutAction.Add,
            functionSelectors: erc20Selectors
        });
        cuts[1] = IDiamondCut.FacetCut({
            facetAddress: governanceFacetAddress,
            action: IDiamondCut.FacetCutAction.Add,
            functionSelectors: governanceSelectors
        });

        // Deploy and initialize the diamond
        ExampleDiamond exampleDiamond = new ExampleDiamond();
        exampleDiamond.init(cuts, owner);
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Ensure all facet addresses and their function selectors are correctly specified during initialization.
- The `owner` address set during initialization should be carefully chosen and secured.
- Use `IDiamondCut.FacetCutAction.Add` to register new facets and `Replace` or `Remove` for upgrades.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Initializes the diamond with provided facet addresses and owner. Ensure that the facet addresses are verified and intended for use. Incorrectly set facet addresses or an insecure owner address can compromise the diamond's functionality and control.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ExampleDiamond",
        href: "/docs/library/diamond/example",
        description: "Module used by ExampleDiamond",
        icon: "ðŸ“¦"
      },
      {
        title: "DiamondInspectFacet",
        href: "/docs/library/diamond",
        description: "Related facet in diamond",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-28T04:49:11.658Z" />
