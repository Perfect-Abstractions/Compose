---
sidebar_position: 99
title: "ExampleDiamond"
description: "Example Diamond for Compose diamond framework"
gitSource: "https://github.com/maxnorm/Compose/blob/5736454575f67743dd05ba6cb1265bc06d0c1422/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Example Diamond for Compose diamond framework
</DocSubtitle>

<Callout type="info" title="Key Features">
- Demonstrates core diamond proxy structure and initialization.
- Supports facet registration and owner assignment.
- Provides a basic fallback and receive function for Ether handling.
</Callout>

## Overview

The ExampleDiamond contract serves as a foundational template within the Compose diamond framework. It demonstrates core diamond proxy functionalities, including facet registration and owner initialization, providing a starting point for custom diamond deployments.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IDiamondCut} from "@compose/diamond-cut/src/interfaces/IDiamondCut.sol";
import {DiamondInit} from "@compose/diamond-init/src/DiamondInit.sol";

contract MyDiamond is IDiamondCut {
    address owner;

    constructor(address _owner, DiamondInit _diamondInit) {
        owner = _owner;
        // Example of calling DiamondInit to add facets
        // _diamondInit.diamondCut(...); // This would typically happen in a separate deployment script
    }

    // Fallback and receive functions would be implemented here or in facets
    fallback() external payable {}
    receive() external payable {}

    // Other diamond functions or facet functions would be exposed via delegatecall
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Use `DiamondInit` or a similar mechanism for facet installation during deployment rather than directly in the constructor for better upgradeability and clarity.
- Ensure the owner is set correctly during initialization to manage diamond upgrades and facet management.
- Implement `fallback` and `receive` functions explicitly or ensure they are handled by registered facets to manage arbitrary calls and Ether reception.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The constructor directly sets the owner. Ensure this initialization is performed securely and by a trusted entity. The `fallback` and `receive` functions, if not implemented in facets, will allow any call or Ether transfer to the diamond, which may be undesirable if not properly guarded by access control mechanisms in other facets.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-21T22:06:27.714Z" />
