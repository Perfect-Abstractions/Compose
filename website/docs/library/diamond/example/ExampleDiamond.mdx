---
sidebar_position: 99
title: "ExampleDiamond"
description: "Example Diamond contract for Compose diamonds"
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Example Diamond contract for Compose diamonds
</DocSubtitle>

<Callout type="info" title="Key Features">
- Manages facet registration and function selector mapping.
- Initializes contract ownership.
- Serves as a template for diamond proxy implementation.
</Callout>

## Overview

The ExampleDiamond contract serves as a foundational template for Compose diamonds. It demonstrates the core diamond proxy pattern by managing facet registrations and ownership initialization. This contract is intended for illustrative purposes, showcasing how facets are added and function selectors are mapped for delegatecall routing.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {ExampleDiamond} from "@compose-protocol/diamond/contracts/ExampleDiamond.sol";
import {DiamondCutFacet} from "@compose-protocol/diamond/contracts/facets/DiamondCutFacet.sol";
import {DiamondLoupeFacet} from "@compose-protocol/diamond/contracts/facets/DiamondLoupeFacet.sol";

// Assume necessary deployments and addresses are available
address owner = address(0x123);
address diamondCutFacetAddress = address(0x456);
address diamondLoupeFacetAddress = address(0x789);

// Example of deploying and initializing a diamond
// In a real scenario, this would be part of a deployment script
// ExampleDiamond exampleDiamond = new ExampleDiamond();
// exampleDiamond.initialize(owner, [
//     ExampleDiamond.FacetCut({
//         facetAddress: diamondCutFacetAddress,
//         action: ExampleDiamond.FacetCutAction.Add,
//         functionSelectors: DiamondCutFacet.getFunctionSelectors()
//     }),
//     ExampleDiamond.FacetCut({
//         facetAddress: diamondLoupeFacetAddress,
//         action: ExampleDiamond.FacetCutAction.Add,
//         functionSelectors: DiamondLoupeFacet.getFunctionSelectors()
//     })
// ]);`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond with facets and the owner during deployment.
- Use explicit initializer functions for setting up the diamond's state.
- Ensure all facets intended for the diamond are correctly registered with their function selectors.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The constructor initializes the diamond and sets the owner. Ensure the owner address provided during initialization is a secure, controlled address. The `fallback` and `receive` functions are present but have no implementation, meaning they will revert if called directly, which is a standard security practice for proxy contracts to prevent unexpected state changes.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-28T04:29:56.737Z" />
