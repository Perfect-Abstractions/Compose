---
sidebar_position: 99
title: "ExampleDiamond"
description: "Example Diamond for Compose, demonstrating core proxy functionality."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Example Diamond for Compose, demonstrating core proxy functionality.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Core diamond proxy functionality for facet routing.
- Initializes diamond with owner and facet mappings.
- Demonstrates basic facet registration and ownership setup.
</Callout>

## Overview

ExampleDiamond serves as a foundational implementation for Compose diamonds. It showcases the basic proxy logic for routing function calls to registered facets and includes essential initialization capabilities for setting up diamond ownership and facet mappings.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IDiamondCut, IDiamondLoupe} from "@compose-diamond/diamond-contracts/contracts/interfaces/IDiamond.sol";
import {ExampleDiamond} from "@compose-diamond/diamond-contracts/contracts/ExampleDiamond.sol";

contract Deployer {
    address owner = msg.sender;

    function deploy() public {
        // Example facets (replace with actual facet addresses and selectors)
        address[] memory facetAddresses = new address[](1);
        facetAddresses[0] = address(0x123); // Replace with actual facet address

        bytes4[][] memory facetSelectors = new bytes4[][](1);
        facetSelectors[0] = new bytes4[](1);
        facetSelectors[0][0] = ExampleDiamond.exampleFunction.selector; // Replace with actual function selector

        ExampleDiamond diamond = new ExampleDiamond(facetAddresses, facetSelectors, owner);

        // Interactions with the deployed diamond would follow here
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond with the owner and all initial facets during deployment.
- Ensure all facets intended for use are correctly registered with their function selectors.
- Use the `IDiamondCut` interface for managing facet additions, replacements, or removals in upgrade scenarios.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Access control for diamond upgrades (add/replace/remove facets) is typically managed by the owner. Ensure the owner address is secure. The `fallback` and `receive` functions are present but have no specific logic defined in this example, relying on the diamond proxy's default behavior.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-23T00:02:22.974Z" />
