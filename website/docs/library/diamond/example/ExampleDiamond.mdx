---
sidebar_position: 510
title: "ExampleDiamond"
description: "Example Diamond for Compose framework"
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Example Diamond for Compose framework
</DocSubtitle>

<Callout type="info" title="Key Features">
- Enables initialization of a diamond proxy with multiple facets.
- Sets the initial owner of the diamond contract.
- Supports direct Ether reception via `receive` and `fallback` functions.
</Callout>

## Overview

The ExampleDiamond contract serves as a foundational template for Compose diamonds. It demonstrates the core diamond proxy pattern by enabling the registration of facets and setting an initial owner. This contract is intended for integration within Compose projects to illustrate facet management and proxy functionality.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import { ExampleDiamond } from "@compose/diamond/example/ExampleDiamond";
import { DiamondMod } from "@compose/diamond/DiamondMod";

contract DeployExampleDiamond {
    address public diamondAddress;

    function deploy() public {
        // Define facets to be added during deployment
        DiamondMod.FacetCut[] memory facets = new DiamondMod.FacetCut[](1);
        // Assuming MyFacet is deployed and its address is known
        address myFacetAddress = address(0x123...); // Replace with actual facet address
        bytes4[] memory selectors = new bytes4[](1);
        selectors[0] = ExampleDiamond.someFunction.selector; // Replace with actual function selector

        facets[0] = DiamondMod.FacetCut({
            facetAddress: myFacetAddress,
            action: DiamondMod.FacetCutAction.Add,
            functionSelectors: selectors
        });

        // Deploy the ExampleDiamond with initial facets and owner
        ExampleDiamond exampleDiamond = new ExampleDiamond(facets, msg.sender);
        diamondAddress = address(exampleDiamond);
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond with necessary facets during deployment using the `constructor`.
- The `constructor` sets the initial owner, which should be managed securely.
- Leverage `fallback` and `receive` for handling Ether transfers to the diamond proxy.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The `constructor` function should only be called once during deployment. Ensure that facet addresses provided during initialization are verified and trusted. The `fallback` and `receive` functions, while allowing Ether transfer, do not include specific logic for handling this Ether, which must be implemented by other facets.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ExampleDiamond",
        href: "/docs/library/diamond/example/ExampleDiamond",
        description: "Module used by ExampleDiamond",
        icon: "ðŸ“¦"
      },
      {
        title: "DiamondInspectFacet",
        href: "/docs/library/diamond/DiamondInspectFacet",
        description: "Related facet in diamond",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-30T15:56:13.967Z" />
