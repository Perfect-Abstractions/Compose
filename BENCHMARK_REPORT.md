

# Diamond Loupe Gas Benchmark Report
    
## Usage


Run the following command to execute the benchmark and generate the .csv results:
```bash
forge script script/LoupeBenchmark.s.sol --gas-limit 1000000000000000000
```

Use a very high gas limit to avoid out-of-gas errors during execution.


Then, convert the CSV results into a Markdown report (BENCHMARK_REPORT.md) with:

```bash
python3 gen_benchmark_report.py 
```
    **Compiler Settings in foundry.toml:**
    - Optimizer Runs: 20,000"
    - viaIR: Disabled
## facets() Function Gas Costs

| Selectors/Facets | CollisionMap | Current | Original | TwoPass |
|----------------|------------|-------|--------|-------|
| 0/0 | 1,874 | 14,907 | 1,706 | 1,870 |
| 2/1 | 7,115 | 18,523 | 5,143 | 7,046 |
| 4/2 | 2,002,261 | 26,578 | 674,899 | 1,341,895 |
| 6/3 | 4,127,058 | 40,382 | 1,392,115 | 2,767,861 |
| 20/7 | 20,974,431 | 575,509 | 7,377,394 | 14,251,089 |
| 40/10 | 53,292,679 | 592,930 | 18,255,994 | 35,992,575 |
| 40/20 | 107,100,679 | 1,248,511 | 37,646,566 | 72,705,035 |
| 50/17 | 113,419,542 | 3,406,976 | 40,951,164 | 77,537,220 |
| 64/16 | 132,015,939 | 1,721,192 | 46,323,852 | 89,519,927 |
| 64/32 | 268,107,777 | 3,907,353 | 105,068,492 | 183,336,799 |
| 64/64 | 554,269,714 | 9,665,934 | 358,049,615 | 385,034,381 |
| 100/34 | 444,475,721 | 16,083,808 | 195,926,200 | 306,807,258 |
| 500/167 | 12,759,480,806 | 6,496,743,157 | 412,743,918,001 | 9,486,080,194 |
| 504/42 | 2,710,860,695 | 476,372,862 | 2,988,018,908 | 1,880,773,198 |
| 1000/84 | 12,394,728,611 | 19,016,404,487 | 116,788,998,936 | 9,114,103,333 |
| 1000/334 | 70,959,700,968 | 287,329,088,062 | 25,222,727,047,770 | 57,917,542,435 |

---
## facetAddresses() Function Gas Costs

| Selectors/Facets | CollisionMap | Current | Original | TwoPass |
|----------------|------------|-------|--------|-------|
| 0/0 | 1,521 | 14,658 | 1,517 | 1,517 |
| 2/1 | 3,338 | 16,941 | 3,290 | 3,290 |
| 4/2 | 9,054 | 22,445 | 8,873 | 8,873 |
| 6/3 | 136,266 | 31,721 | 58,653 | 97,481 |
| 20/7 | 781,208 | 144,461 | 389,442 | 583,577 |
| 40/10 | 1,550,140 | 348,789 | 914,992 | 1,225,609 |
| 40/20 | 3,830,889 | 691,167 | 2,415,736 | 3,114,623 |
| 50/17 | 3,470,011 | 765,407 | 2,277,689 | 2,860,094 |
| 64/16 | 3,608,796 | 870,348 | 2,484,699 | 3,028,278 |
| 64/32 | 9,394,958 | 1,764,199 | 7,135,187 | 8,299,997 |
| 64/64 | 27,501,437 | 3,619,639 | 22,705,513 | 25,112,787 |
| 100/34 | 14,260,364 | 3,005,909 | 11,622,812 | 12,906,578 |
| 500/167 | 996,474,214 | 128,985,456 | 980,322,384 | 986,728,840 |
| 504/42 | 81,595,959 | 21,112,642 | 77,571,901 | 79,124,981 |
| 1000/84 | 550,598,314 | 126,709,953 | 540,077,603 | 543,261,417 |
| 1000/334 | 7,662,167,469 | 1,188,630,496 | 7,621,451,283 | 7,634,419,506 |

---
